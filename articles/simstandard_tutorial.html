<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="simstandard">
<title>Using the simstandard package â€¢ simstandard</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Using the simstandard package">
<meta property="og:description" content="simstandard">
<meta property="og:image" content="https://wjschne.github.io/simstandard/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">simstandard</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/simstandard_tutorial.html">Using the simstandard package</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/wjschne/simstandard/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Using the simstandard package</h1>
                        <h4 data-toc-skip class="author">W. Joel
Schneider</h4>
            
            <h4 data-toc-skip class="date">2024-04-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/wjschne/simstandard/blob/HEAD/vignettes/simstandard_tutorial.Rmd" class="external-link"><code>vignettes/simstandard_tutorial.Rmd</code></a></small>
      <div class="d-none name"><code>simstandard_tutorial.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="purpose-of-simstandard">Purpose of simstandard<a class="anchor" aria-label="anchor" href="#purpose-of-simstandard"></a>
</h2>
<p>In the figure below, you can see a hypothetical structural model with
its standardized loadings and path coefficients.</p>
<p><img src="ModelFigure.png" width="700" height="100%" style="display: block; margin: auto;"></p>
<p>Suppose you need to simulate multivariate normal data based on this
model, but you do not know the error variances and the latent
disturbance variances needed to make your model produce standardized
data. It is often difficult to find such values algebraically, and
instead they must be found iteratively.</p>
<p>The simstandard package finds the standardized variances and creates
standardized multivariate normal data using <a href="https://lavaan.ugent.be/tutorial/syntax1.html" class="external-link">lavaan syntax</a>.
It can also create latent variable scores, error terms, disturbance
terms, estimated factor scores, and equally weighted composite scores
for each latent variable.</p>
</div>
<div class="section level2">
<h2 id="generate-model-based-multivariate-data">Generate Model-Based Multivariate Data<a class="anchor" aria-label="anchor" href="#generate-model-based-multivariate-data"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/wjschne/simstandard" class="external-link">simstandard</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># lavaan syntax for model</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">A =~ 0.7 * A1 + 0.8 * A2 + 0.9 * A3 + 0.3 * B1</span></span>
<span><span class="st">B =~ 0.7 * B1 + 0.8 * B2 + 0.9 * B3</span></span>
<span><span class="st">B ~ 0.6 * A</span></span>
<span><span class="st">"</span></span>
<span></span>
<span><span class="co"># Simulate data</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_standardized.html">sim_standardized</a></span><span class="op">(</span><span class="va">m</span>, n <span class="op">=</span> <span class="fl">100000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display First 6 rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 Ã— 15</span></span></span>
<span><span class="co">#&gt;        A1     A2     A3     B1     B2     B3       A      B   e_A1   e_A2</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  1.51    0.884  1.03   2.38   3.58   2.87   1.31    2.79   0.595 -<span style="color: #BB0000;">0.166</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  1.57    0.587  0.514  0.334  0.509  1.12   1.05    0.678  0.834 -<span style="color: #BB0000;">0.256</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">0.498</span>   0.589  0.762  0.363 -<span style="color: #BB0000;">0.313</span>  0.705  0.038<span style="text-decoration: underline;">5</span>  0.175 -<span style="color: #BB0000;">0.525</span>  0.558</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> -<span style="color: #BB0000;">0.269</span>  -<span style="color: #BB0000;">0.941</span> -<span style="color: #BB0000;">0.763</span> -<span style="color: #BB0000;">0.288</span>  0.217 -<span style="color: #BB0000;">0.683</span> -<span style="color: #BB0000;">0.856</span>  -<span style="color: #BB0000;">0.458</span>  0.330 -<span style="color: #BB0000;">0.256</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> -<span style="color: #BB0000;">0.016</span><span style="color: #BB0000; text-decoration: underline;">3</span> -<span style="color: #BB0000;">0.814</span>  0.447 -<span style="color: #BB0000;">0.226</span>  0.723  0.203  1.04   -<span style="color: #BB0000;">0.266</span> -<span style="color: #BB0000;">0.747</span> -<span style="color: #BB0000;">1.65</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> -<span style="color: #BB0000;">1.44</span>   -<span style="color: #BB0000;">0.192</span> -<span style="color: #BB0000;">0.795</span> -<span style="color: #BB0000;">1.13</span>  -<span style="color: #BB0000;">0.441</span> -<span style="color: #BB0000;">0.822</span> -<span style="color: #BB0000;">0.966</span>  -<span style="color: #BB0000;">0.671</span> -<span style="color: #BB0000;">0.765</span>  0.581</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 5 more variables: e_A3 &lt;dbl&gt;, e_B1 &lt;dbl&gt;, e_B2 &lt;dbl&gt;, e_B3 &lt;dbl&gt;, d_B &lt;dbl&gt;</span></span></span></code></pre></div>
<p>Letâ€™s make a function to display correlations and covariance
matrices:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ggcor</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span><span class="st">"rowname"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">rowname</span>, names_to <span class="op">=</span> <span class="st">"colname"</span>, values_to <span class="op">=</span> <span class="st">"r"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>rowname <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html" class="external-link">fct_inorder</a></span><span class="op">(</span><span class="va">rowname</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>                    <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html" class="external-link">fct_rev</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>colname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">colname</span>,</span>
<span>                                   levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">rowname</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">colname</span>, <span class="va">rowname</span>, fill <span class="op">=</span> <span class="va">r</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>        label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/formatc.html" class="external-link">formatC</a></span><span class="op">(</span><span class="va">r</span>, digits <span class="op">=</span> <span class="fl">2</span>, format <span class="op">=</span> <span class="st">"f"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>          <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html" class="external-link">str_replace_all</a></span><span class="op">(</span><span class="st">"0\\."</span>, <span class="st">"."</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>          <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html" class="external-link">str_replace_all</a></span><span class="op">(</span><span class="st">"1.00"</span>, <span class="st">"1"</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      color <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>      fontface <span class="op">=</span> <span class="st">"bold"</span>,</span>
<span>      family <span class="op">=</span> <span class="st">"serif"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span></span>
<span>      <span class="cn">NULL</span>,</span>
<span>      na.value <span class="op">=</span> <span class="st">"gray20"</span>,</span>
<span>      limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.01</span>, <span class="fl">1.01</span><span class="op">)</span>,</span>
<span>      high <span class="op">=</span> <span class="st">"#924552"</span>,</span>
<span>      low <span class="op">=</span> <span class="st">"#293999"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_equal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span><span class="cn">NULL</span>, position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_y_discrete</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"serif"</span>, base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Because the data are standardized, the covariance matrix of the
observed and latent variables should be nearly identical to a
correlation matrix. The error and disturbance terms are not
standardized.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggcor</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="simstandard_tutorial_files/figure-html/modelcov-1.png" width="100%" height="100%"></p>
<p>To return only the observed variables</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_standardized.html">sim_standardized</a></span><span class="op">(</span><span class="va">m</span>,</span>
<span>                      n <span class="op">=</span> <span class="fl">100000</span>,</span>
<span>                      latent <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                      errors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># Display First 6 rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 Ã— 6</span></span></span>
<span><span class="co">#&gt;       A1     A2      A3     B1      B2      B3</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  1.61   1.15   2.06    0.903 -<span style="color: #BB0000;">0.047</span><span style="color: #BB0000; text-decoration: underline;">2</span> -<span style="color: #BB0000;">0.075</span><span style="color: #BB0000; text-decoration: underline;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  1.46   1.50   0.684   0.125 -<span style="color: #BB0000;">0.483</span>   0.339 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">0.891</span> -<span style="color: #BB0000;">1.19</span>  -<span style="color: #BB0000;">1.22</span>   -<span style="color: #BB0000;">0.517</span>  0.396  -<span style="color: #BB0000;">0.725</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  0.133 -<span style="color: #BB0000;">1.55</span>  -<span style="color: #BB0000;">0.787</span>  -<span style="color: #BB0000;">1.00</span>  -<span style="color: #BB0000;">0.171</span>  -<span style="color: #BB0000;">1.18</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> -<span style="color: #BB0000;">0.929</span> -<span style="color: #BB0000;">1.64</span>  -<span style="color: #BB0000;">0.964</span>  -<span style="color: #BB0000;">1.23</span>  -<span style="color: #BB0000;">1.51</span>   -<span style="color: #BB0000;">1.01</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> -<span style="color: #BB0000;">0.434</span> -<span style="color: #BB0000;">0.242</span> -<span style="color: #BB0000;">0.097</span><span style="color: #BB0000; text-decoration: underline;">3</span> -<span style="color: #BB0000;">0.869</span> -<span style="color: #BB0000;">0.781</span>  -<span style="color: #BB0000;">1.21</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="comparison-with-lavaansimulatedata">Comparison with <code>lavaan::simulateData</code><a class="anchor" aria-label="anchor" href="#comparison-with-lavaansimulatedata"></a>
</h2>
<p>I love the lavaan package. However, one aspect of one function in
lavaan is not quite right yet. lavaanâ€™s <code>simulateData</code>
function <a href="https://github.com/yrosseel/lavaan/issues/46" class="external-link">is known
to generate non-standardized data</a>, even when the
<code>standardized</code> parameter is set to <code>TRUE</code>. See how
it creates variable Y with a variance higher than 1.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_model</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">Y ~ -.75 * X_1 + .25 * X_2</span></span>
<span><span class="st">X =~ .75 * X_1 + .75 * X_2</span></span>
<span><span class="st">"</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span>
<span><span class="va">d_lavaan</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/simulateData.html" class="external-link">simulateData</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">test_model</span>,</span>
<span>                         sample.nobs <span class="op">=</span> <span class="fl">100000</span>,</span>
<span>                         standardized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">d_lavaan</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggcor</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="simstandard_tutorial_files/figure-html/lavaan-1.png" width="100%" height="100%"></p>
<p>With the same test model, simstandard will calculate variables with
variances of 1.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sim_standardized.html">sim_standardized</a></span><span class="op">(</span><span class="va">test_model</span>,</span>
<span>                 n <span class="op">=</span> <span class="fl">100000</span>,</span>
<span>                 errors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="va">cov</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggcor</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="simstandard_tutorial_files/figure-html/simstandard_comparison-1.png" width="100%" height="100%"></p>
</div>
<div class="section level2">
<h2 id="inspecting-model-matrices">Inspecting model matrices<a class="anchor" aria-label="anchor" href="#inspecting-model-matrices"></a>
</h2>
<p>You can inspect the matrices that simstandard uses to create the data
by calling <code>simstandardized_matrices</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">matrices</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_standardized_matrices.html">sim_standardized_matrices</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></code></pre></div>
<p>The A matrix contains all the asymmetric path coefficients (i.e., the
loadings and the structural coefficients). These coefficients are
specified in the lavaan model syntax.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">matrices</span><span class="op">$</span><span class="va">RAM_matrices</span><span class="op">$</span><span class="va">A</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggcor</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="simstandard_tutorial_files/figure-html/Amatrix-1.png" width="100%" height="100%"></p>
<p>The S matrix contains all the symmetric path coefficients (i.e., the
variances and correlations of the observed and latent variables). For
endogenous variables, the variances and correlations refer to the
variance and correlations of the variableâ€™s associated error or
disturbance term. In this case, A is the only endogenous variable, and
thus its variance on the diagonal of the S matrix is 1.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">matrices</span><span class="op">$</span><span class="va">RAM_matrices</span><span class="op">$</span><span class="va">S</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggcor</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="simstandard_tutorial_files/figure-html/Smatrix-1.png" width="100%" height="100%"></p>
<p>Thus, we can use these results to insert the missing values from the
path diagram at the beginning of this tutorial</p>
<p><img src="ModelFigureComplete.png" width="700" height="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="estimated-factor-scores">Estimated Factor Scores<a class="anchor" aria-label="anchor" href="#estimated-factor-scores"></a>
</h2>
<p>If you want to estimate factor scores using the regression method
(i.e., Thurstoneâ€™s method), set <code>factor_scores</code> to
<code>TRUE</code>. All scores ending in <em>FS</em> are factor score
estimates.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">A =~ 0.9 * A1 + 0.8 * A2 + 0.7 * A3</span></span>
<span><span class="st">"</span></span>
<span><span class="fu"><a href="../reference/sim_standardized.html">sim_standardized</a></span><span class="op">(</span><span class="va">m</span>,</span>
<span>                 n <span class="op">=</span> <span class="fl">100000</span>,</span>
<span>                 factor_scores <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 Ã— 8</span></span></span>
<span><span class="co">#&gt;       A1     A2     A3       A    e_A1    e_A2   e_A3   A_FS</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">0.186</span> -<span style="color: #BB0000;">0.189</span> -<span style="color: #BB0000;">0.291</span>  0.035<span style="text-decoration: underline;">6</span> -<span style="color: #BB0000;">0.218</span>  -<span style="color: #BB0000;">0.218</span>  -<span style="color: #BB0000;">0.316</span> -<span style="color: #BB0000;">0.212</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> -<span style="color: #BB0000;">1.75</span>  -<span style="color: #BB0000;">0.500</span> -<span style="color: #BB0000;">0.411</span> -<span style="color: #BB0000;">1.50</span>   -<span style="color: #BB0000;">0.398</span>   0.701   0.639 -<span style="color: #BB0000;">1.24</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">0.957</span> -<span style="color: #BB0000;">0.851</span> -<span style="color: #BB0000;">2.47</span>  -<span style="color: #BB0000;">1.10</span>    0.033<span style="text-decoration: underline;">1</span>  0.029<span style="text-decoration: underline;">3</span> -<span style="color: #BB0000;">1.70</span>  -<span style="color: #BB0000;">1.23</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  0.836  1.37  -<span style="color: #BB0000;">0.980</span>  1.30   -<span style="color: #BB0000;">0.337</span>   0.322  -<span style="color: #BB0000;">1.89</span>   0.706</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> -<span style="color: #BB0000;">0.780</span> -<span style="color: #BB0000;">0.411</span> -<span style="color: #BB0000;">1.96</span>  -<span style="color: #BB0000;">1.31</span>    0.397   0.634  -<span style="color: #BB0000;">1.05</span>  -<span style="color: #BB0000;">0.912</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>  1.03  -<span style="color: #BB0000;">0.243</span>  0.505  0.465   0.613  -<span style="color: #BB0000;">0.615</span>   0.179  0.630</span></span></code></pre></div>
<div class="section level3">
<h3 id="adding-factor-scores-to-new-data">Adding factor scores to new data<a class="anchor" aria-label="anchor" href="#adding-factor-scores-to-new-data"></a>
</h3>
<p>Suppose you have some new data and wish to add estimated factor
scores to it. The <code>add_factor_scores</code> function will take your
data and return your data with the estimated factors added to it.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">A1</span>,  <span class="op">~</span><span class="va">A2</span>,  <span class="op">~</span><span class="va">A3</span>,</span>
<span>   <span class="fl">2L</span>,  <span class="fl">2.5</span>,  <span class="fl">1.3</span>,</span>
<span>  <span class="op">-</span><span class="fl">1L</span>, <span class="op">-</span><span class="fl">1.5</span>, <span class="op">-</span><span class="fl">2.1</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/add_factor_scores.html">add_factor_scores</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt;   A1   A2   A3      A_FS</span></span>
<span><span class="co">#&gt; 1  2  2.5  1.3  2.101242</span></span>
<span><span class="co">#&gt; 2 -1 -1.5 -2.1 -1.368772</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="composite-scores">Composite Scores<a class="anchor" aria-label="anchor" href="#composite-scores"></a>
</h2>
<p>If you want to calculate equally-weighted composite scores based on
the indicators of each latent variable, set `composites = TRUEâ€™.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">A =~ 0.9 * A1 + 0.8 * A2 + 0.7 * A3</span></span>
<span><span class="st">"</span></span>
<span><span class="fu"><a href="../reference/sim_standardized.html">sim_standardized</a></span><span class="op">(</span></span>
<span>  <span class="va">m</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">100000</span>,</span>
<span>  composites <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 Ã— 8</span></span></span>
<span><span class="co">#&gt;       A1     A2     A3      A   e_A1   e_A2   e_A3 A_Composite</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  0.138 -<span style="color: #BB0000;">0.699</span> -<span style="color: #BB0000;">0.234</span> -<span style="color: #BB0000;">0.446</span>  0.539 -<span style="color: #BB0000;">0.342</span> 0.078<span style="text-decoration: underline;">1</span>      -<span style="color: #BB0000;">0.304</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> -<span style="color: #BB0000;">0.600</span> -<span style="color: #BB0000;">0.794</span>  0.121 -<span style="color: #BB0000;">0.472</span> -<span style="color: #BB0000;">0.176</span> -<span style="color: #BB0000;">0.416</span> 0.452       -<span style="color: #BB0000;">0.487</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">0.339</span>  0.611  0.240  0.150 -<span style="color: #BB0000;">0.474</span>  0.491 0.135        0.196</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  1.56   1.38   1.39   1.27   0.417  0.367 0.502        1.66 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> -<span style="color: #BB0000;">1.51</span>  -<span style="color: #BB0000;">0.985</span>  0.420 -<span style="color: #BB0000;">1.46</span>  -<span style="color: #BB0000;">0.199</span>  0.182 1.44        -<span style="color: #BB0000;">0.795</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>  0.527  1.07   2.20   0.416  0.152  0.736 1.91         1.45</span></span></code></pre></div>
<p>Composite scores with equal weights can also be added to new
data:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/add_composite_scores.html">add_composite_scores</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt;   A1   A2   A3 A_Composite</span></span>
<span><span class="co">#&gt; 1  2  2.5  1.3    2.220935</span></span>
<span><span class="co">#&gt; 2 -1 -1.5 -2.1   -1.761431</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="return-lavaan-syntax-with-all-parameters-set-free">Return lavaan syntax with all parameters set free<a class="anchor" aria-label="anchor" href="#return-lavaan-syntax-with-all-parameters-set-free"></a>
</h2>
<p>Suppose that we want to verify that the data generated by the
<code>sim_standardized</code> function is correct. We will need an
analogous model, but with all the fixed parameters set free. We could
manually remove the fixed parameter values, but with large models the
process is tedious and introduces a risk of error. The
<code>fixed2free</code> function painlessly removes the fixed parameters
values from the model.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># lavaan syntax for model</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">A =~ 0.7 * A1 + 0.8 * A2 + 0.9 * A3 + 0.3 * B1</span></span>
<span><span class="st">B =~ 0.7 * B1 + 0.8 * B2 + 0.9 * B3</span></span>
<span><span class="st">B ~ 0.6 * A</span></span>
<span><span class="st">"</span></span>
<span><span class="co"># Make model m free</span></span>
<span><span class="va">m_free</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fixed2free.html">fixed2free</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="co"># Display model m_free</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">m_free</span><span class="op">)</span></span>
<span><span class="co">#&gt; B ~ A</span></span>
<span><span class="co">#&gt; A =~ A1 + A2 + A3 + B1</span></span>
<span><span class="co">#&gt; B =~ B1 + B2 + B3</span></span></code></pre></div>
<p>Now letâ€™s use lavaan to see if the observed data in <code>d</code>
conform to the model in <code>m_free</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set the random number generator for reproducible results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span></span>
<span><span class="co"># Generate data based on model m</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_standardized.html">sim_standardized</a></span><span class="op">(</span></span>
<span>  <span class="va">m</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">100000</span>,</span>
<span>  latent <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  errors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Evaluate the fit of model m_free on data d</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span>
<span><span class="va">lav_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="va">m_free</span>,</span>
<span>  data <span class="op">=</span> <span class="va">d</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display summary of model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span></span>
<span>  <span class="va">lav_results</span>,</span>
<span>  standardized <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6.17 ended normally after 27 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        14</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                        100000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                                 7.493</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 7</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                           0.379</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test statistic                            371352.125</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                15</span></span>
<span><span class="co">#&gt;   P-value                                        0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; User Model versus Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Comparative Fit Index (CFI)                    1.000</span></span>
<span><span class="co">#&gt;   Tucker-Lewis Index (TLI)                       1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Loglikelihood and Information Criteria:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Loglikelihood user model (H0)            -666610.982</span></span>
<span><span class="co">#&gt;   Loglikelihood unrestricted model (H1)    -666607.236</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Akaike (AIC)                             1333249.965</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                           1333383.146</span></span>
<span><span class="co">#&gt;   Sample-size adjusted Bayesian (SABIC)    1333338.653</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Root Mean Square Error of Approximation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   RMSEA                                          0.001</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - lower         0.000</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - upper         0.004</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &lt;= 0.050                    1.000</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &gt;= 0.080                    0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standardized Root Mean Square Residual:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   SRMR                                           0.001</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span><span class="co">#&gt;   Information                                 Expected</span></span>
<span><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   A =~                                                                  </span></span>
<span><span class="co">#&gt;     A1                1.000                               0.703    0.703</span></span>
<span><span class="co">#&gt;     A2                1.142    0.005  231.116    0.000    0.803    0.800</span></span>
<span><span class="co">#&gt;     A3                1.284    0.005  247.676    0.000    0.903    0.901</span></span>
<span><span class="co">#&gt;     B1                0.427    0.004  114.547    0.000    0.300    0.300</span></span>
<span><span class="co">#&gt;   B =~                                                                  </span></span>
<span><span class="co">#&gt;     B1                1.000                               0.701    0.700</span></span>
<span><span class="co">#&gt;     B2                1.139    0.005  238.139    0.000    0.798    0.798</span></span>
<span><span class="co">#&gt;     B3                1.288    0.005  247.366    0.000    0.902    0.901</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   B ~                                                                   </span></span>
<span><span class="co">#&gt;     A                 0.597    0.004  141.196    0.000    0.599    0.599</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .A1                0.507    0.003  194.579    0.000    0.507    0.506</span></span>
<span><span class="co">#&gt;    .A2                0.362    0.002  165.904    0.000    0.362    0.359</span></span>
<span><span class="co">#&gt;    .A3                0.188    0.002   97.276    0.000    0.188    0.188</span></span>
<span><span class="co">#&gt;    .B1                0.170    0.001  130.982    0.000    0.170    0.169</span></span>
<span><span class="co">#&gt;    .B2                0.362    0.002  178.775    0.000    0.362    0.362</span></span>
<span><span class="co">#&gt;    .B3                0.189    0.002  106.863    0.000    0.189    0.189</span></span>
<span><span class="co">#&gt;     A                 0.495    0.004  121.519    0.000    1.000    1.000</span></span>
<span><span class="co">#&gt;    .B                 0.315    0.003  124.248    0.000    0.641    0.641</span></span>
<span></span>
<span><span class="co"># Extract RAM paths</span></span>
<span><span class="va">ram</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lav2ram.html">lav2ram</a></span><span class="op">(</span><span class="va">lav_results</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display asymmetric paths (i.e., single-headed arrows for</span></span>
<span><span class="co"># loadings and structure coefficients)</span></span>
<span><span class="va">ram</span><span class="op">$</span><span class="va">A</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">ggcor</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="simstandard_tutorial_files/figure-html/lavaantest-1.png" width="100%" height="100%"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Display symmetric paths (i.e., curved double-headed arrows</span></span>
<span><span class="co"># exogenous variances, error variances, disturbance variances,</span></span>
<span><span class="co"># and any covariances among these)</span></span>
<span><span class="va">ram</span><span class="op">$</span><span class="va">S</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">ggcor</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="simstandard_tutorial_files/figure-html/lavaantest-2.png" width="100%" height="100%"></p>
<p>As can be seen, all the fit measures indicate a near-perfect fit, and
the parameter estimates are within rounding error of the fixed
parameters in model <code>m</code>.</p>
</div>
<div class="section level2">
<h2 id="return-lavaan-syntax-for-a-model-with-standardized-variances-specified">Return lavaan syntax for a model with standardized variances
specified<a class="anchor" aria-label="anchor" href="#return-lavaan-syntax-for-a-model-with-standardized-variances-specified"></a>
</h2>
<p>Although the <code>simstandardized</code> function will generate data
for you, you might want to use a function from a different package
instead, such as <code><a href="https://rdrr.io/pkg/lavaan/man/simulateData.html" class="external-link">lavaan::simulateData</a></code> or
<code>simsem::sim</code>. In this case, you can use the
<code>model_complete</code> function to output the lavaan syntax for a
standardized model with all standardized variances specified.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify model</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">A =~ 0.7 * A1 + 0.8 * A2 + 0.9 * A3 + 0.3 * B1</span></span>
<span><span class="st">B =~ 0.7 * B1 + 0.8 * B2 + 0.9 * B3</span></span>
<span><span class="st">B ~ 0.6 * A</span></span>
<span><span class="st">"</span></span>
<span><span class="va">m_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_complete.html">model_complete</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="co"># Display complete model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">m_complete</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; A =~ 0.7 * A1 + 0.8 * A2 + 0.9 * A3 + 0.3 * B1</span></span>
<span><span class="co">#&gt; B =~ 0.7 * B1 + 0.8 * B2 + 0.9 * B3</span></span>
<span><span class="co">#&gt; B ~ 0.6 * A</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # Variances</span></span>
<span><span class="co">#&gt; A1 ~~ 0.51 * A1</span></span>
<span><span class="co">#&gt; A2 ~~ 0.36 * A2</span></span>
<span><span class="co">#&gt; A3 ~~ 0.19 * A3</span></span>
<span><span class="co">#&gt; B1 ~~ 0.168 * B1</span></span>
<span><span class="co">#&gt; B2 ~~ 0.36 * B2</span></span>
<span><span class="co">#&gt; B3 ~~ 0.19 * B3</span></span>
<span><span class="co">#&gt; A ~~ 1 * A</span></span>
<span><span class="co">#&gt; B ~~ 0.64 * B</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="return-lavaan-syntax-from-matrices">Return lavaan syntax from matrices<a class="anchor" aria-label="anchor" href="#return-lavaan-syntax-from-matrices"></a>
</h2>
<p>Suppose that a research article provides model coefficients in a
table. We could spend time creating lavaan syntax by hand, but such work
can be tedious. The <code>matrix2lavaan</code> function can help save
time when the models are already specified in matrix form.</p>
<div class="section level3">
<h3 id="the-measurement-model">The measurement model<a class="anchor" aria-label="anchor" href="#the-measurement-model"></a>
</h3>
<p>The measurement model can be specified with a matrix in which the
column names are latent variables and the row names are indicator
variables.</p>
<p>Here we have three latent variables, Vocabulary, Working Memory
Capacity, and Reading, each defined by three indicator variables.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_meas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">.8</span>, <span class="fl">0</span>, <span class="fl">0</span>,  <span class="co"># VC1</span></span>
<span>  <span class="fl">.9</span>, <span class="fl">0</span>, <span class="fl">0</span>,  <span class="co"># VC2</span></span>
<span>  <span class="fl">.7</span>, <span class="fl">0</span>, <span class="fl">0</span>,  <span class="co"># VC3</span></span>
<span>  <span class="fl">0</span>, <span class="fl">.6</span>, <span class="fl">0</span>,  <span class="co"># WM1</span></span>
<span>  <span class="fl">0</span>, <span class="fl">.7</span>, <span class="fl">0</span>,  <span class="co"># WM2</span></span>
<span>  <span class="fl">0</span>, <span class="fl">.8</span>, <span class="fl">0</span>,  <span class="co"># WM3</span></span>
<span>  <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">.9</span>,  <span class="co"># RD1</span></span>
<span>  <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">.7</span>,  <span class="co"># RD2</span></span>
<span>  <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">.8</span><span class="op">)</span>, <span class="co"># RD3</span></span>
<span>  nrow <span class="op">=</span> <span class="fl">9</span>,</span>
<span>  byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"VC1"</span>, <span class="st">"VC2"</span>, <span class="st">"VC3"</span>,</span>
<span>      <span class="st">"WM1"</span>, <span class="st">"WM2"</span>, <span class="st">"WM3"</span>,</span>
<span>      <span class="st">"RD1"</span>, <span class="st">"RD2"</span>, <span class="st">"RD3"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vocabulary"</span>, <span class="st">"WorkingMemory"</span>, <span class="st">"Reading"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-structural-model">The structural model<a class="anchor" aria-label="anchor" href="#the-structural-model"></a>
</h3>
<p>The structural model can be specified with a matrix in which the
predictors are the column names and the criterion variables are the row
names.</p>
<p>Here we have Vocabulary and Working Memory Capacity predicting
Reading Scores.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_struct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>                   ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                   dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Reading"</span>,</span>
<span>                                   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vocabulary"</span>, <span class="st">"WorkingMemory"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This could have been a 3 by 3 matrix with zeroes (which are
ignored).</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_struct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,   <span class="fl">0</span>,   <span class="fl">0</span>,  <span class="co"># Vocabulary</span></span>
<span>                     <span class="fl">0</span>,   <span class="fl">0</span>,   <span class="fl">0</span>,  <span class="co"># WorkingMemory</span></span>
<span>                     <span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0</span><span class="op">)</span>, <span class="co"># Reading</span></span>
<span>                   nrow <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                   byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">m_struct</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vocabulary"</span>, <span class="st">"WorkingMemory"</span>, <span class="st">"Reading"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">m_struct</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vocabulary"</span>, <span class="st">"WorkingMemory"</span>, <span class="st">"Reading"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="covariances">Covariances<a class="anchor" aria-label="anchor" href="#covariances"></a>
</h3>
<p>The variances and covariances must be specified as a symmetric
matrix, though variables can be omitted.</p>
<p>Here we specify that the latent variables Vocabulary and Working
Memory Capacity are correlated.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,   <span class="fl">0.5</span>,</span>
<span>                  <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                nrow <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vocabulary"</span>, <span class="st">"WorkingMemory"</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vocabulary"</span>, <span class="st">"WorkingMemory"</span><span class="op">)</span></span>
<span>                <span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="using-the-matrix2lavaan-function">Using the <code>matrix2lavaan</code> function<a class="anchor" aria-label="anchor" href="#using-the-matrix2lavaan-function"></a>
</h3>
<p>The <code>matrix2lavaan</code> function takes arguments for the
measurement model, structural model, and covariances. Any of the three
matrices can be omitted.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/matrix2lavaan.html">matrix2lavaan</a></span><span class="op">(</span>measurement_model <span class="op">=</span> <span class="va">m_meas</span>,</span>
<span>                       structural_model <span class="op">=</span> <span class="va">m_struct</span>,</span>
<span>                       covariances <span class="op">=</span> <span class="va">m_cov</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; Vocabulary =~ 0.8 * VC1 + 0.9 * VC2 + 0.7 * VC3</span></span>
<span><span class="co">#&gt; WorkingMemory =~ 0.6 * WM1 + 0.7 * WM2 + 0.8 * WM3</span></span>
<span><span class="co">#&gt; Reading =~ 0.9 * RD1 + 0.7 * RD2 + 0.8 * RD3</span></span>
<span><span class="co">#&gt; Reading ~ 0.4 * Vocabulary + 0.3 * WorkingMemory</span></span>
<span><span class="co">#&gt; Vocabulary ~~ 0.5 * WorkingMemory</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="specifying-models-with-data-frames-instead-of-matrices">Specifying models with data.frames instead of matrices<a class="anchor" aria-label="anchor" href="#specifying-models-with-data-frames-instead-of-matrices"></a>
</h3>
<p>As an alternative, the <code>matrix2lavaan</code> function can take
data.frames (or tibbles) with either rownames or the first column as a
character vector.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># A tibble with indicator variables listed in the first column</span></span>
<span><span class="va">m_meas</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>     <span class="op">~</span><span class="va">Test</span>, <span class="op">~</span><span class="va">Vocabulary</span>, <span class="op">~</span><span class="va">WorkingMemory</span>, <span class="op">~</span><span class="va">Reading</span>,</span>
<span>     <span class="st">"VC1"</span>,         <span class="fl">0.8</span>,              <span class="fl">0</span>,        <span class="fl">0</span>,</span>
<span>     <span class="st">"VC2"</span>,         <span class="fl">0.9</span>,              <span class="fl">0</span>,        <span class="fl">0</span>,</span>
<span>     <span class="st">"VC3"</span>,         <span class="fl">0.7</span>,              <span class="fl">0</span>,        <span class="fl">0</span>,</span>
<span>     <span class="st">"WM1"</span>,           <span class="fl">0</span>,            <span class="fl">0.6</span>,        <span class="fl">0</span>,</span>
<span>     <span class="st">"WM2"</span>,           <span class="fl">0</span>,            <span class="fl">0.7</span>,        <span class="fl">0</span>,</span>
<span>     <span class="st">"WM3"</span>,           <span class="fl">0</span>,            <span class="fl">0.8</span>,        <span class="fl">0</span>,</span>
<span>     <span class="st">"RD1"</span>,           <span class="fl">0</span>,              <span class="fl">0</span>,      <span class="fl">0.9</span>,</span>
<span>     <span class="st">"RD2"</span>,           <span class="fl">0</span>,              <span class="fl">0</span>,      <span class="fl">0.7</span>,</span>
<span>     <span class="st">"RD3"</span>,           <span class="fl">0</span>,              <span class="fl">0</span>,      <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># A data.frame with criterion variable specified as a row name</span></span>
<span><span class="va">m_struct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Vocabulary <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>                       WorkingMemory <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                       row.names <span class="op">=</span> <span class="st">"Reading"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># A data.frame with variable names specified as row names</span></span>
<span><span class="va">m_cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Vocabulary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                    WorkingMemory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">m_cov</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vocabulary"</span>, <span class="st">"WorkingMemory"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/matrix2lavaan.html">matrix2lavaan</a></span><span class="op">(</span>measurement_model <span class="op">=</span> <span class="va">m_meas</span>,</span>
<span>                       structural_model <span class="op">=</span> <span class="va">m_struct</span>,</span>
<span>                       covariances <span class="op">=</span> <span class="va">m_cov</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="return-model-implied-correlation-matrices">Return model-implied correlation matrices<a class="anchor" aria-label="anchor" href="#return-model-implied-correlation-matrices"></a>
</h2>
<p>After specifying a standardized model with lavaan syntax, we can
extract a model-implied correlation matrix. By default, we extract just
the correlations among the observed variables.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_model_implied_correlations.html">get_model_implied_correlations</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggcor</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="simstandard_tutorial_files/figure-html/modelimpliedcor-1.png" width="100%" height="100%"></p>
<p>It is possible to extract the model-implied correlations among the
observed variables, latent variables, error terms, factor scores, and
composite variables. For example, here we extract correlations among the
observed and latent variables:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_model_implied_correlations.html">get_model_implied_correlations</a></span><span class="op">(</span></span>
<span>  <span class="va">m</span>,</span>
<span>  latent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggcor</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="simstandard_tutorial_files/figure-html/corplot-1.png" width="100%" height="100%"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># lavaan syntax for model</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">A =~ 0.7 * A1 + 0.8 * A2 + 0.9 * A3 + 0.3 * B1</span></span>
<span><span class="st">B =~ 0.7 * B1 + 0.8 * B2 + 0.9 * B3</span></span>
<span><span class="st">B ~ 0.6 * A</span></span>
<span><span class="st"></span></span>
<span><span class="st"># Variances</span></span>
<span><span class="st">A1 ~~ 0.51 * A1</span></span>
<span><span class="st">A2 ~~ 0.36 * A2</span></span>
<span><span class="st">A3 ~~ 0.19 * A3</span></span>
<span><span class="st">B1 ~~ 0.168 * B1</span></span>
<span><span class="st">B2 ~~ 0.36 * B2</span></span>
<span><span class="st">B3 ~~ 0.19 * B3</span></span>
<span><span class="st">A ~~ 1 * A</span></span>
<span><span class="st">B ~~ 0.64 * B</span></span>
<span><span class="st">"</span></span>
<span></span>
<span><span class="va">m_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/model.syntax.html" class="external-link">lavaanify</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> </span>
<span>  </span>
<span></span>
<span><span class="co"># mRAM &lt;- lavMatrixRepresentation(m_fit, </span></span>
<span>                                <span class="co"># representation = "RAM")</span></span>
<span></span>
<span><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    v_latent_exogenous <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavNames.html" class="external-link">lavNames</a></span><span class="op">(</span><span class="va">m_fit</span>, <span class="st">"lv.x"</span><span class="op">)</span>,</span>
<span>    v_latent_endogenous <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavNames.html" class="external-link">lavNames</a></span><span class="op">(</span><span class="va">m_fit</span>, <span class="st">"lv.nox"</span><span class="op">)</span>,</span>
<span>    v_observed_exogenous <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavNames.html" class="external-link">lavNames</a></span><span class="op">(</span><span class="va">m_fit</span>, <span class="st">"ov.x"</span><span class="op">)</span>,</span>
<span>    v_observed_endogenous <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavNames.html" class="external-link">lavNames</a></span><span class="op">(</span><span class="va">m_fit</span>, <span class="st">"ov.nox"</span><span class="op">)</span>,</span>
<span>    v_observed_indicator <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavNames.html" class="external-link">lavNames</a></span><span class="op">(</span><span class="va">m_fit</span>, <span class="st">"ov.ind"</span><span class="op">)</span>,</span>
<span>    v_disturbance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"d_"</span>, <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavNames.html" class="external-link">lavNames</a></span><span class="op">(</span><span class="va">m_fit</span>, <span class="st">"lv.nox"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    v_error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"e_"</span>, <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavNames.html" class="external-link">lavNames</a></span><span class="op">(</span><span class="va">m_fit</span>, <span class="st">"ov.nox"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">v</span><span class="op">$</span><span class="va">v_residual</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">v_error</span>,</span>
<span>                        <span class="va">v</span><span class="op">$</span><span class="va">v_disturbance</span><span class="op">)</span></span>
<span><span class="va">v</span><span class="op">$</span><span class="va">v_exogenous</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">v_residual</span>,</span>
<span>                         <span class="va">v</span><span class="op">$</span><span class="va">v_observed_exogenous</span>,</span>
<span>                         <span class="va">v</span><span class="op">$</span><span class="va">v_latent_exogenous</span><span class="op">)</span></span>
<span><span class="va">v</span><span class="op">$</span><span class="va">v_endogenous</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">v_observed_endogenous</span>,</span>
<span>                          <span class="va">v</span><span class="op">$</span><span class="va">v_latent_endogenous</span><span class="op">)</span></span>
<span><span class="va">v</span><span class="op">$</span><span class="va">v_modeled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">v_endogenous</span>,</span>
<span>                       <span class="va">v</span><span class="op">$</span><span class="va">v_latent_exogenous</span>,</span>
<span>                       <span class="va">v</span><span class="op">$</span><span class="va">v_observed_exogenous</span><span class="op">)</span></span>
<span><span class="va">v</span><span class="op">$</span><span class="va">v_observed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">v_observed_exogenous</span>, </span>
<span>                        <span class="va">v</span><span class="op">$</span><span class="va">v_observed_endogenous</span><span class="op">)</span></span>
<span><span class="va">v</span><span class="op">$</span><span class="va">v_latent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">v_latent_exogenous</span>, </span>
<span>                      <span class="va">v</span><span class="op">$</span><span class="va">v_latent_endogenous</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Reduced ram</span></span>
<span><span class="va">rram</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">rram</span><span class="op">$</span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, </span>
<span>                 nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">v_modeled</span><span class="op">)</span>, </span>
<span>                 ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">v_modeled</span><span class="op">)</span>, </span>
<span>                 dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">v_modeled</span>, <span class="va">v</span><span class="op">$</span><span class="va">v_modeled</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rram</span><span class="op">$</span><span class="va">S</span> <span class="op">&lt;-</span> <span class="va">rram</span><span class="op">$</span><span class="va">A</span> </span>
<span><span class="va">rram</span><span class="op">$</span><span class="cn">F</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  <span class="fl">0</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">v_observed</span><span class="op">)</span>,</span>
<span>  ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">v_modeled</span><span class="op">)</span>,</span>
<span>  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">v_observed</span>, <span class="va">v</span><span class="op">$</span><span class="va">v_modeled</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">m_fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">op</span> <span class="op">==</span> <span class="st">"=~"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">rhs</span>, <span class="va">lhs</span>, <span class="va">ustart</span><span class="op">)</span></span>
<span><span class="co">#&gt;   rhs lhs ustart</span></span>
<span><span class="co">#&gt; 1  A1   A    0.7</span></span>
<span><span class="co">#&gt; 2  A2   A    0.8</span></span>
<span><span class="co">#&gt; 3  A3   A    0.9</span></span>
<span><span class="co">#&gt; 4  B1   A    0.3</span></span>
<span><span class="co">#&gt; 5  B1   B    0.7</span></span>
<span><span class="co">#&gt; 6  B2   B    0.8</span></span>
<span><span class="co">#&gt; 7  B3   B    0.9</span></span>
<span></span>
<span><span class="va">m_fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">op</span> <span class="op">==</span> <span class="st">"~"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">lhs</span>, <span class="va">rhs</span>, <span class="va">ustart</span><span class="op">)</span></span>
<span><span class="co">#&gt;   lhs rhs ustart</span></span>
<span><span class="co">#&gt; 1   B   A    0.6</span></span>
<span></span>
<span><span class="va">d_A</span> <span class="op">&lt;-</span> <span class="va">m_fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">op</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"=~"</span>, <span class="st">"~"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cause <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">op</span> <span class="op">==</span> <span class="st">"~"</span>, <span class="va">rhs</span>, <span class="va">lhs</span><span class="op">)</span>,</span>
<span>         effect <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">op</span> <span class="op">==</span> <span class="st">"~"</span>, <span class="va">lhs</span>, <span class="va">rhs</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d_S</span> <span class="op">&lt;-</span> <span class="va">m_fit</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">op</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"~~"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">rram</span><span class="op">$</span><span class="va">A</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">d_A</span><span class="op">$</span><span class="va">effect</span>, <span class="va">d_A</span><span class="op">$</span><span class="va">cause</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">d_A</span><span class="op">$</span><span class="va">ustart</span></span>
<span><span class="va">rram</span><span class="op">$</span><span class="va">S</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">d_S</span><span class="op">$</span><span class="va">lhs</span>, <span class="va">d_S</span><span class="op">$</span><span class="va">rhs</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">d_S</span><span class="op">$</span><span class="va">ustart</span></span>
<span><span class="va">rram</span><span class="op">$</span><span class="va">S</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">d_S</span><span class="op">$</span><span class="va">rhs</span>, <span class="va">d_S</span><span class="op">$</span><span class="va">lhs</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">d_S</span><span class="op">$</span><span class="va">ustart</span></span>
<span><span class="va">rram</span><span class="op">$</span><span class="cn">F</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">v_observed</span>, <span class="va">v</span><span class="op">$</span><span class="va">v_observed</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">rram</span><span class="op">$</span><span class="va">S</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">v_exogenous</span>, <span class="va">v</span><span class="op">$</span><span class="va">v_exogenous</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">extended_diag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">rram</span><span class="op">$</span><span class="va">A</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">v_residual</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">`dimnames&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">rram</span><span class="op">$</span><span class="va">A</span><span class="op">)</span>, <span class="va">v</span><span class="op">$</span><span class="va">v_residual</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">`diag&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">rram</span><span class="op">$</span><span class="va">S</span><span class="op">[</span><span class="va">v</span><span class="op">$</span><span class="va">v_residual</span>, <span class="va">v</span><span class="op">$</span><span class="va">v_residual</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">extended_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">rram</span><span class="op">$</span><span class="va">A</span>, <span class="va">extended_diag</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">v_residual</span><span class="op">)</span>,</span>
<span>               ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">v_residual</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">rram</span><span class="op">$</span><span class="va">A</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">`rownames&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Identity matrix the same size as A and S</span></span>
<span><span class="va">I</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">extended_A</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Inverted I - A for total effects (direct + indirect)</span></span>
<span><span class="va">iA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">I</span> <span class="op">-</span> <span class="va">extended_A</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Exogenous covariance matrix</span></span>
<span><span class="va">extended_S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, </span>
<span>                     nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">extended_A</span><span class="op">)</span>, </span>
<span>                     ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">extended_A</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">`dimnames&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">extended_A</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># diag(extended_S) &lt;- 1</span></span>
<span><span class="va">extended_S</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">rram</span><span class="op">$</span><span class="va">S</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">rram</span><span class="op">$</span><span class="va">S</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="va">extended_cov</span> <span class="op">&lt;-</span> <span class="va">iA</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">extended_S</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">iA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">extended_mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">extended_A</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">`names&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">extended_A</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">extended_mu</span><span class="op">[</span><span class="va">v</span><span class="op">$</span><span class="va">v_residual</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">rram</span><span class="op">$</span><span class="va">S</span>, symmetric <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#&gt; eigen() decomposition</span></span>
<span><span class="co">#&gt; $values</span></span>
<span><span class="co">#&gt; [1] 1.000 0.640 0.510 0.360 0.360 0.190 0.190 0.168</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vectors</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]</span></span>
<span><span class="co">#&gt; [1,]    0    0    1    0    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    0    0    1    0    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    0    0    0    0    1    0</span></span>
<span><span class="co">#&gt; [4,]    0    0    0    0    0    0    0    1</span></span>
<span><span class="co">#&gt; [5,]    0    0    0    0    1    0    0    0</span></span>
<span><span class="co">#&gt; [6,]    0    0    0    0    0    1    0    0</span></span>
<span><span class="co">#&gt; [7,]    0    1    0    0    0    0    0    0</span></span>
<span><span class="co">#&gt; [8,]    1    0    0    0    0    0    0    0</span></span>
<span></span>
<span></span>
<span><span class="op">(</span><span class="op">(</span><span class="va">iA</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">extended_S</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">iA</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,<span class="va">v</span><span class="op">$</span><span class="va">v_exogenous</span><span class="op">]</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span><span class="st">"variable"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">variable</span>, names_to <span class="op">=</span> <span class="st">"exogenous"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">value</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">exogenous</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">variable</span>, <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">exogenous</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="simstandard_tutorial_files/figure-html/msyntax-1.png" width="100%" height="100%"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span></span>
<span><span class="op">(</span><span class="va">iA</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">extended_S</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">iA</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="va">v</span><span class="op">$</span><span class="va">v_endogenous</span>,<span class="va">v</span><span class="op">$</span><span class="va">v_exogenous</span><span class="op">]</span></span>
<span><span class="co">#&gt;         e_A1 e_A2      e_A3     e_B1 e_B2      e_B3  d_B    A</span></span>
<span><span class="co">#&gt; A1 0.7141428  0.0 0.0000000 0.000000  0.0 0.0000000 0.00 0.70</span></span>
<span><span class="co">#&gt; A2 0.0000000  0.6 0.0000000 0.000000  0.0 0.0000000 0.00 0.80</span></span>
<span><span class="co">#&gt; A3 0.0000000  0.0 0.4358899 0.000000  0.0 0.0000000 0.00 0.90</span></span>
<span><span class="co">#&gt; B1 0.0000000  0.0 0.0000000 0.409878  0.0 0.0000000 0.56 0.72</span></span>
<span><span class="co">#&gt; B2 0.0000000  0.0 0.0000000 0.000000  0.6 0.0000000 0.64 0.48</span></span>
<span><span class="co">#&gt; B3 0.0000000  0.0 0.0000000 0.000000  0.0 0.4358899 0.72 0.54</span></span>
<span><span class="co">#&gt; B  0.0000000  0.0 0.0000000 0.000000  0.0 0.0000000 0.80 0.60</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by W. Joel Schneider.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
