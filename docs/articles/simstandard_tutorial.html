<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using the simstandard package • simstandard</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Using the simstandard package">
<meta property="og:description" content="simstandard">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">simstandard</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simstandard_tutorial.html">Using the simstandard package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/wjschne/simstandard/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="simstandard_tutorial_files/header-attrs-2.4/header-attrs.js"></script><script src="simstandard_tutorial_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using the simstandard package</h1>
                        <h4 class="author">W. Joel Schneider</h4>
            
            <h4 class="date">2020-10-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/wjschne/simstandard/blob/master/vignettes/simstandard_tutorial.Rmd"><code>vignettes/simstandard_tutorial.Rmd</code></a></small>
      <div class="hidden name"><code>simstandard_tutorial.Rmd</code></div>

    </div>

    
    
<p><img src="logo.png" align="right" height="140/"></p>
<div id="purpose-of-simstandard" class="section level1">
<h1 class="hasAnchor">
<a href="#purpose-of-simstandard" class="anchor"></a>Purpose of simstandard</h1>
<p>In the figure below, you can see a hypothetical structural model with its standardized loadings and path coefficients.</p>
<p><img src="ModelFigure.svg" width="700" height="100%" style="display: block; margin: auto;"></p>
<p>Suppose you need to simulate multivariate normal data based on this model, but you do not know the error variances and the latent disturbance variances needed to make your model produce standardized data. It is often difficult to find such values algebraically, and instead they must be found iteratively.</p>
<p>The simstandard package finds the standardized variances and creates standardized multivariate normal data using <a href="https://lavaan.ugent.be/tutorial/syntax1.html">lavaan syntax</a>. It can also create latent variable scores, error terms, disturbance terms, estimated factor scores, and equally weighted composite scores for each latent variable.</p>
</div>
<div id="generate-model-based-multivariate-data" class="section level1">
<h1 class="hasAnchor">
<a href="#generate-model-based-multivariate-data" class="anchor"></a>Generate Model-Based Multivariate Data</h1>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/wjschne/simstandard">simstandard</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://lavaan.org">lavaan</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/">tibble</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>

<span class="co"># lavaan syntax for model</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="st">"
A =~ 0.7 * A1 + 0.8 * A2 + 0.9 * A3 + 0.3 * B1
B =~ 0.7 * B1 + 0.8 * B2 + 0.9 * B3
B ~ 0.6 * A
"</span>

<span class="co"># Simulate data</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_standardized.html">sim_standardized</a></span><span class="op">(</span><span class="va">m</span>, n <span class="op">=</span> <span class="fl">100000</span><span class="op">)</span>

<span class="co"># Display First 6 rows</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 15</span>
<span class="co">#&gt;        A1     A2     A3     B1     B2     B3       A      B   e_A1   e_A2</span>
<span class="co">#&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1  1.51    0.884  1.03   2.38   3.58   2.87   1.31    2.79   0.595 -0.166</span>
<span class="co">#&gt; 2  1.57    0.587  0.514  0.334  0.509  1.12   1.05    0.678  0.834 -0.256</span>
<span class="co">#&gt; 3 -0.498   0.589  0.762  0.363 -0.313  0.705  0.0385  0.175 -0.525  0.558</span>
<span class="co">#&gt; 4 -0.269  -0.941 -0.763 -0.288  0.217 -0.683 -0.856  -0.458  0.330 -0.256</span>
<span class="co">#&gt; 5 -0.0163 -0.814  0.447 -0.226  0.723  0.203  1.04   -0.266 -0.747 -1.65 </span>
<span class="co">#&gt; 6 -1.44   -0.192 -0.795 -1.13  -0.441 -0.822 -0.966  -0.671 -0.765  0.581</span>
<span class="co">#&gt; # ... with 5 more variables: e_A3 &lt;dbl&gt;, e_B1 &lt;dbl&gt;, e_B2 &lt;dbl&gt;, e_B3 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   d_B &lt;dbl&gt;</span></pre></div>
<p>Let’s make a function to display correlations and covariance matrices:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="va">ggcor</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"rowname"</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span><span class="op">(</span><span class="va">colname</span>, <span class="va">r</span>, <span class="op">-</span><span class="va">rowname</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>rowname <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html">fct_rev</a></span><span class="op">(</span><span class="va">rowname</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>colname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">colname</span>, 
                                   levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">rowname</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">colname</span>, <span class="va">rowname</span>, fill <span class="op">=</span> <span class="va">r</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/formatc.html">formatC</a></span><span class="op">(</span><span class="va">r</span>, digits <span class="op">=</span> <span class="fl">2</span>, format <span class="op">=</span> <span class="st">"f"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
                    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="st">"0\\."</span>,<span class="st">"."</span><span class="op">)</span> <span class="op">%&gt;%</span> 
                    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="st">"1.00"</span>,<span class="st">"1"</span><span class="op">)</span><span class="op">)</span>, 
    color <span class="op">=</span> <span class="st">"white"</span>, 
    fontface <span class="op">=</span> <span class="st">"bold"</span>,
    family <span class="op">=</span> <span class="st">"serif"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient2</a></span><span class="op">(</span><span class="cn">NULL</span>,
                         na.value <span class="op">=</span> <span class="st">"gray20"</span>,
                         limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.01</span>, <span class="fl">1.01</span><span class="op">)</span>,
                         high <span class="op">=</span> <span class="st">"#924552"</span>,
                         low <span class="op">=</span> <span class="st">"#293999"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_equal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span><span class="cn">NULL</span>,position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_y_discrete</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"serif"</span>, base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> 
<span class="op">}</span></pre></div>
<p>Because the data are standardized, the covariance matrix of the observed and latent variables should be nearly identical to a correlation matrix. The error and disturbance terms are not standardized.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="va">ggcor</span></pre></div>
<p><img src="simstandard_tutorial_files/figure-html/modelcov-1.svg" width="100%" height="100%"></p>
<p>To return only the observed variables</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_standardized.html">sim_standardized</a></span><span class="op">(</span><span class="va">m</span>,
                      n <span class="op">=</span> <span class="fl">100000</span>,
                      latent <span class="op">=</span> <span class="cn">FALSE</span>,
                      errors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co"># Display First 6 rows</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span> 
<span class="co">#&gt; # A tibble: 6 x 6</span>
<span class="co">#&gt;       A1     A2      A3     B1      B2      B3</span>
<span class="co">#&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1  1.61   1.15   2.06    0.903 -0.0472 -0.0756</span>
<span class="co">#&gt; 2  1.46   1.50   0.684   0.125 -0.483   0.339 </span>
<span class="co">#&gt; 3 -0.891 -1.19  -1.22   -0.517  0.396  -0.725 </span>
<span class="co">#&gt; 4  0.133 -1.55  -0.787  -1.00  -0.171  -1.18  </span>
<span class="co">#&gt; 5 -0.929 -1.64  -0.964  -1.23  -1.51   -1.01  </span>
<span class="co">#&gt; 6 -0.434 -0.242 -0.0973 -0.869 -0.781  -1.21</span></pre></div>
</div>
<div id="comparison-with-lavaansimulatedata" class="section level1">
<h1 class="hasAnchor">
<a href="#comparison-with-lavaansimulatedata" class="anchor"></a>Comparison with <code>lavaan::simulateData</code>
</h1>
<p>I love the lavaan package. However, one aspect of one function in lavaan is not quite right yet. lavaan’s <code>simulateData</code> function <a href="https://github.com/yrosseel/lavaan/issues/46">is known to generate non-standardized data</a>, even when the <code>standardized</code> parameter is set to <code>TRUE</code>. See how it creates variable Y with a variance higher than 1.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="va">test_model</span> <span class="op">&lt;-</span> <span class="st">"
Y ~ -.75 * X_1 + .25 * X_2
X =~ .75 * X_1 + .75 * X_2
"</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://lavaan.org">lavaan</a></span><span class="op">)</span>
<span class="va">d_lavaan</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/simulateData.html">simulateData</a></span><span class="op">(</span>
  model <span class="op">=</span> <span class="va">test_model</span>, 
  sample.nobs <span class="op">=</span> <span class="fl">100000</span>, 
  standardized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">d_lavaan</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="va">ggcor</span></pre></div>
<p><img src="simstandard_tutorial_files/figure-html/lavaan-1.svg" width="100%" height="100%"></p>
<p>With the same test model, simstandard will calculate variables with variances of 1.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="fu"><a href="../reference/sim_standardized.html">sim_standardized</a></span><span class="op">(</span><span class="va">test_model</span>, 
                 n <span class="op">=</span> <span class="fl">100000</span>, 
                 errors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="va">cov</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggcor</span><span class="op">(</span><span class="op">)</span></pre></div>
<p><img src="simstandard_tutorial_files/figure-html/simstandard_comparison-1.svg" width="100%" height="100%"></p>
</div>
<div id="inspecting-model-matrices" class="section level1">
<h1 class="hasAnchor">
<a href="#inspecting-model-matrices" class="anchor"></a>Inspecting model matrices</h1>
<p>You can inspect the matrices that simstandard uses to create the data by calling <code>simstandardized_matrices</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="va">matrices</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_standardized_matrices.html">sim_standardized_matrices</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></pre></div>
<p>The A matrix contains all the asymmetric path coefficients (i.e., the loadings and the structural coefficients). These coefficients are specified in the lavaan model syntax.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="va">matrices</span><span class="op">$</span><span class="va">RAM_matrices</span><span class="op">$</span><span class="va">A</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggcor</span><span class="op">(</span><span class="op">)</span></pre></div>
<p><img src="simstandard_tutorial_files/figure-html/Amatrix-1.svg" width="100%" height="100%"></p>
<p>The S matrix contains all the symmetric path coefficients (i.e., the variances and correlations of the observed and latent variables). For endogenous variables, the variances and correlations refer to the variance and correlations of the variable’s associated error or disturbance term. In this case, A is the only endogenous variable, and thus its variance on the diagonal of the S matrix is 1.</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="va">matrices</span><span class="op">$</span><span class="va">RAM_matrices</span><span class="op">$</span><span class="va">S</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggcor</span><span class="op">(</span><span class="op">)</span></pre></div>
<p><img src="simstandard_tutorial_files/figure-html/Smatrix-1.svg" width="100%" height="100%"></p>
<p>Thus, we can use these results to insert the missing values from the path diagram at the beginning of this tutorial</p>
<p><img src="ModelFigureComplete.svg" width="700" height="100%" style="display: block; margin: auto;"></p>
</div>
<div id="estimated-factor-scores" class="section level1">
<h1 class="hasAnchor">
<a href="#estimated-factor-scores" class="anchor"></a>Estimated Factor Scores</h1>
<p>If you want to estimate factor scores using the regression method (i.e., Thurstone’s method), set <code>factor_scores</code> to <code>TRUE</code>. All scores ending in <em>FS</em> are factor score estimates.</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="va">m</span> <span class="op">&lt;-</span> <span class="st">"
A =~ 0.9 * A1 + 0.8 * A2 + 0.7 * A3
"</span>
<span class="fu"><a href="../reference/sim_standardized.html">sim_standardized</a></span><span class="op">(</span>
  <span class="va">m</span>, 
  n <span class="op">=</span> <span class="fl">100000</span>, 
  factor_scores <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span> 
<span class="co">#&gt; # A tibble: 6 x 11</span>
<span class="co">#&gt;       A1     A2     A3       A    e_A1    e_A2   e_A3   A_FS e_A1_FS e_A2_FS</span>
<span class="co">#&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 -0.186 -0.189 -0.291  0.0356 -0.218  -0.218  -0.316 -0.212  0.0122 -0.0320</span>
<span class="co">#&gt; 2 -1.75  -0.500 -0.411 -1.50   -0.398   0.701   0.639 -1.24  -1.44    0.826 </span>
<span class="co">#&gt; 3 -0.957 -0.851 -2.47  -1.10    0.0331  0.0293 -1.70  -1.23   0.337   0.217 </span>
<span class="co">#&gt; 4  0.836  1.37  -0.980  1.30   -0.337   0.322  -1.89   0.706  0.461   1.33  </span>
<span class="co">#&gt; 5 -0.780 -0.411 -1.96  -1.31    0.397   0.634  -1.05  -0.912  0.0947  0.531 </span>
<span class="co">#&gt; 6  1.03  -0.243  0.505  0.465   0.613  -0.615   0.179  0.630  1.07   -1.24  </span>
<span class="co">#&gt; # ... with 1 more variable: e_A3_FS &lt;dbl&gt;</span></pre></div>
<div id="adding-factor-scores-to-new-data" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-factor-scores-to-new-data" class="anchor"></a>Adding factor scores to new data</h2>
<p>Suppose you have some new data and wish to add estimated factor scores to it. The <code>add_factor_scores</code> function will take your data and return your data with the estimated factors added to it.</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
  <span class="op">~</span><span class="va">A1</span>,  <span class="op">~</span><span class="va">A2</span>,  <span class="op">~</span><span class="va">A3</span>,
   <span class="fl">2L</span>,  <span class="fl">2.5</span>,  <span class="fl">1.3</span>,
  <span class="op">-</span><span class="fl">1L</span>, <span class="op">-</span><span class="fl">1.5</span>, <span class="op">-</span><span class="fl">2.1</span>
  <span class="op">)</span>

<span class="fu"><a href="../reference/add_factor_scores.html">add_factor_scores</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">m</span> <span class="op">)</span> 
<span class="co">#&gt;   A1   A2   A3    A</span>
<span class="co">#&gt; 1  2  2.5  1.3  2.1</span>
<span class="co">#&gt; 2 -1 -1.5 -2.1 -1.4</span></pre></div>
</div>
</div>
<div id="composite-scores" class="section level1">
<h1 class="hasAnchor">
<a href="#composite-scores" class="anchor"></a>Composite Scores</h1>
<p>If you want to calculate equally-weighted composite scores based on the indicators of each latent variable, set `composites = TRUE’.</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="va">m</span> <span class="op">&lt;-</span> <span class="st">"
A =~ 0.9 * A1 + 0.8 * A2 + 0.7 * A3
"</span>
<span class="fu"><a href="../reference/sim_standardized.html">sim_standardized</a></span><span class="op">(</span>
  <span class="va">m</span>, 
  n <span class="op">=</span> <span class="fl">100000</span>, 
  composites <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 8</span>
<span class="co">#&gt;       A1     A2     A3      A   e_A1   e_A2   e_A3 A_Composite</span>
<span class="co">#&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt; 1  0.138 -0.699 -0.234 -0.446  0.539 -0.342 0.0781      -0.304</span>
<span class="co">#&gt; 2 -0.600 -0.794  0.121 -0.472 -0.176 -0.416 0.452       -0.487</span>
<span class="co">#&gt; 3 -0.339  0.611  0.240  0.150 -0.474  0.491 0.135        0.196</span>
<span class="co">#&gt; 4  1.56   1.38   1.39   1.27   0.417  0.367 0.502        1.66 </span>
<span class="co">#&gt; 5 -1.51  -0.985  0.420 -1.46  -0.199  0.182 1.44        -0.795</span>
<span class="co">#&gt; 6  0.527  1.07   2.20   0.416  0.152  0.736 1.91         1.45</span></pre></div>
<p>Composite scores with equal weights can also be added to new data:</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="fu"><a href="../reference/add_composite_scores.html">add_composite_scores</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">m</span> <span class="op">)</span> 
<span class="co">#&gt;   A1   A2   A3 A_Composite</span>
<span class="co">#&gt; 1  2  2.5  1.3         2.2</span>
<span class="co">#&gt; 2 -1 -1.5 -2.1        -1.8</span></pre></div>
</div>
<div id="return-lavaan-syntax-with-all-parameters-set-free" class="section level1">
<h1 class="hasAnchor">
<a href="#return-lavaan-syntax-with-all-parameters-set-free" class="anchor"></a>Return lavaan syntax with all parameters set free</h1>
<p>Suppose that we want to verify that the data generated by the <code>sim_standardized</code> function is correct. We will need an analogous model, but with all the fixed parameters set free. We could manually remove the fixed parameter values, but with large models the process is tedious and introduces a risk of error. The <code>fixed2free</code> function painlessly removes the fixed parameters values from the model.</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="co"># lavaan syntax for model</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="st">"
A =~ 0.7 * A1 + 0.8 * A2 + 0.9 * A3 + 0.3 * B1
B =~ 0.7 * B1 + 0.8 * B2 + 0.9 * B3
B ~ 0.6 * A
"</span>
<span class="co"># Make model m free</span>
<span class="va">m_free</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fixed2free.html">fixed2free</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>
<span class="co"># Display model m_free</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="va">m_free</span><span class="op">)</span>
<span class="co">#&gt; A =~ A1 + A2 + A3 + B1</span>
<span class="co">#&gt; B =~ B1 + B2 + B3</span>
<span class="co">#&gt; B ~ A</span></pre></div>
<p>Now let’s use lavaan to see if the observed data in <code>d</code> conform to the model in <code>m_free</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="co"># Set the random number generator for reproducible results</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span>
<span class="co"># Generate data based on model m</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_standardized.html">sim_standardized</a></span><span class="op">(</span>
  <span class="va">m</span>,
  n <span class="op">=</span> <span class="fl">100000</span>,
  latent <span class="op">=</span> <span class="cn">FALSE</span>,
  errors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># Evaluate the fit of model m_free on data d</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://lavaan.org">lavaan</a></span><span class="op">)</span>
<span class="va">lav_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span>
  model <span class="op">=</span> <span class="va">m_free</span>, 
  data <span class="op">=</span> <span class="va">d</span><span class="op">)</span>

<span class="co"># Display summary of model</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span>
  <span class="va">lav_results</span>, 
  standardized <span class="op">=</span> <span class="cn">TRUE</span>, 
  fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; lavaan 0.6-7 ended normally after 27 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Estimator                                         ML</span>
<span class="co">#&gt;   Optimization method                           NLMINB</span>
<span class="co">#&gt;   Number of free parameters                         14</span>
<span class="co">#&gt;                                                       </span>
<span class="co">#&gt;   Number of observations                        100000</span>
<span class="co">#&gt;                                                       </span>
<span class="co">#&gt; Model Test User Model:</span>
<span class="co">#&gt;                                                       </span>
<span class="co">#&gt;   Test statistic                                 7.493</span>
<span class="co">#&gt;   Degrees of freedom                                 7</span>
<span class="co">#&gt;   P-value (Chi-square)                           0.379</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model Test Baseline Model:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Test statistic                            371352.125</span>
<span class="co">#&gt;   Degrees of freedom                                15</span>
<span class="co">#&gt;   P-value                                        0.000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; User Model versus Baseline Model:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Comparative Fit Index (CFI)                    1.000</span>
<span class="co">#&gt;   Tucker-Lewis Index (TLI)                       1.000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Loglikelihood and Information Criteria:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Loglikelihood user model (H0)            -666610.982</span>
<span class="co">#&gt;   Loglikelihood unrestricted model (H1)    -666607.236</span>
<span class="co">#&gt;                                                       </span>
<span class="co">#&gt;   Akaike (AIC)                             1333249.965</span>
<span class="co">#&gt;   Bayesian (BIC)                           1333383.146</span>
<span class="co">#&gt;   Sample-size adjusted Bayesian (BIC)      1333338.653</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Root Mean Square Error of Approximation:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   RMSEA                                          0.001</span>
<span class="co">#&gt;   90 Percent confidence interval - lower         0.000</span>
<span class="co">#&gt;   90 Percent confidence interval - upper         0.004</span>
<span class="co">#&gt;   P-value RMSEA &lt;= 0.05                          1.000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Standardized Root Mean Square Residual:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   SRMR                                           0.001</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Parameter Estimates:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Standard errors                             Standard</span>
<span class="co">#&gt;   Information                                 Expected</span>
<span class="co">#&gt;   Information saturated (h1) model          Structured</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Latent Variables:</span>
<span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span>
<span class="co">#&gt;   A =~                                                                  </span>
<span class="co">#&gt;     A1                1.000                               0.703    0.703</span>
<span class="co">#&gt;     A2                1.142    0.005  231.116    0.000    0.803    0.800</span>
<span class="co">#&gt;     A3                1.284    0.005  247.676    0.000    0.903    0.901</span>
<span class="co">#&gt;     B1                0.427    0.004  114.547    0.000    0.300    0.300</span>
<span class="co">#&gt;   B =~                                                                  </span>
<span class="co">#&gt;     B1                1.000                               0.701    0.700</span>
<span class="co">#&gt;     B2                1.139    0.005  238.139    0.000    0.798    0.798</span>
<span class="co">#&gt;     B3                1.288    0.005  247.366    0.000    0.902    0.901</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Regressions:</span>
<span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span>
<span class="co">#&gt;   B ~                                                                   </span>
<span class="co">#&gt;     A                 0.597    0.004  141.196    0.000    0.599    0.599</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Variances:</span>
<span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span>
<span class="co">#&gt;    .A1                0.507    0.003  194.579    0.000    0.507    0.506</span>
<span class="co">#&gt;    .A2                0.362    0.002  165.904    0.000    0.362    0.359</span>
<span class="co">#&gt;    .A3                0.188    0.002   97.276    0.000    0.188    0.188</span>
<span class="co">#&gt;    .B1                0.170    0.001  130.982    0.000    0.170    0.169</span>
<span class="co">#&gt;    .B2                0.362    0.002  178.775    0.000    0.362    0.362</span>
<span class="co">#&gt;    .B3                0.189    0.002  106.863    0.000    0.189    0.189</span>
<span class="co">#&gt;     A                 0.495    0.004  121.519    0.000    1.000    1.000</span>
<span class="co">#&gt;    .B                 0.315    0.003  124.248    0.000    0.641    0.641</span>

<span class="co"># Extract RAM paths</span>
<span class="va">RAM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lav2ram.html">lav2ram</a></span><span class="op">(</span><span class="va">lav_results</span><span class="op">)</span>

<span class="co"># Display asymmetric paths (i.e., single-headed arrows for </span>
<span class="co"># loadings and structure coefficients)</span>
<span class="va">RAM</span><span class="op">$</span><span class="va">A</span> <span class="op">%&gt;%</span> <span class="fu">ggcor</span><span class="op">(</span><span class="op">)</span></pre></div>
<p><img src="simstandard_tutorial_files/figure-html/lavaantest-1.svg" width="100%" height="100%"></p>
<div class="sourceCode" id="cb16"><pre class="downlit">

<span class="co"># Display symmetric paths (i.e., curved double-headed arrows</span>
<span class="co"># exogenous variances, error variances, disturbance variances, </span>
<span class="co"># and any covariances among these)</span>
<span class="va">RAM</span><span class="op">$</span><span class="va">S</span> <span class="op">%&gt;%</span> <span class="fu">ggcor</span><span class="op">(</span><span class="op">)</span></pre></div>
<p><img src="simstandard_tutorial_files/figure-html/lavaantest-2.svg" width="100%" height="100%"></p>
<p>As can be seen, all the fit measures indicate a near-perfect fit, and the parameter estimates are within rounding error of the fixed parameters in model <code>m</code>.</p>
</div>
<div id="return-lavaan-syntax-for-a-model-with-standardized-variances-specified" class="section level1">
<h1 class="hasAnchor">
<a href="#return-lavaan-syntax-for-a-model-with-standardized-variances-specified" class="anchor"></a>Return lavaan syntax for a model with standardized variances specified</h1>
<p>Although the <code>simstandardized</code> function will generate data for you, you might want to use a function from a different package instead, such as <code><a href="https://rdrr.io/pkg/lavaan/man/simulateData.html">lavaan::simulateData</a></code> or <code><a href="https://rdrr.io/pkg/simsem/man/sim.html">simsem::sim</a></code>. In this case, you can use the <code>model_complete</code> function to output the lavaan syntax for a standardized model with all standardized variances specified.</p>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="co"># Specify model</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="st">"
A =~ 0.7 * A1 + 0.8 * A2 + 0.9 * A3 + 0.3 * B1
B =~ 0.7 * B1 + 0.8 * B2 + 0.9 * B3
B ~ 0.6 * A
"</span>
<span class="va">m_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_complete.html">model_complete</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>
<span class="co"># Display complete model</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="va">m_complete</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; A =~ 0.7 * A1 + 0.8 * A2 + 0.9 * A3 + 0.3 * B1</span>
<span class="co">#&gt; B =~ 0.7 * B1 + 0.8 * B2 + 0.9 * B3</span>
<span class="co">#&gt; B ~ 0.6 * A</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # Variances</span>
<span class="co">#&gt; A1 ~~ 0.51 * A1</span>
<span class="co">#&gt; A2 ~~ 0.36 * A2</span>
<span class="co">#&gt; A3 ~~ 0.19 * A3</span>
<span class="co">#&gt; B1 ~~ 0.168 * B1</span>
<span class="co">#&gt; B2 ~~ 0.36 * B2</span>
<span class="co">#&gt; B3 ~~ 0.19 * B3</span>
<span class="co">#&gt; A ~~ 1 * A</span>
<span class="co">#&gt; B ~~ 0.64 * B</span></pre></div>
</div>
<div id="return-lavaan-syntax-from-matrices" class="section level1">
<h1 class="hasAnchor">
<a href="#return-lavaan-syntax-from-matrices" class="anchor"></a>Return lavaan syntax from matrices</h1>
<p>Suppose that a research article provides model coefficients in a table. We could spend time creating lavaan syntax by hand, but such work can be tedious. The <code>matrix2lavaan</code> function can help save time when the models are already specified in matrix form.</p>
<div id="the-measurement-model" class="section level2">
<h2 class="hasAnchor">
<a href="#the-measurement-model" class="anchor"></a>The measurement model</h2>
<p>The measurement model can be specified with a matrix in which the column names are latent variables and the row names are indicator variables.</p>
<p>Here we have three latent variables, Vocabulary, Working Memory Capacity, and Reading, each defined by three indicator variables.</p>
<div class="sourceCode" id="cb18"><pre class="downlit">
<span class="va">m_meas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="fl">0.8</span>,<span class="fl">0</span>,<span class="fl">0</span>,  <span class="co"># VC1</span>
    <span class="fl">0.9</span>,<span class="fl">0</span>,<span class="fl">0</span>,  <span class="co"># VC2</span>
    <span class="fl">0.7</span>,<span class="fl">0</span>,<span class="fl">0</span>,  <span class="co"># VC3</span>
    <span class="fl">0</span>,<span class="fl">0.6</span>,<span class="fl">0</span>,  <span class="co"># WM1</span>
    <span class="fl">0</span>,<span class="fl">0.7</span>,<span class="fl">0</span>,  <span class="co"># WM2</span>
    <span class="fl">0</span>,<span class="fl">0.8</span>,<span class="fl">0</span>,  <span class="co"># WM3</span>
    <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.9</span>,  <span class="co"># RD1</span>
    <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.7</span>,  <span class="co"># RD2</span>
    <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.8</span><span class="op">)</span>, <span class="co"># RD3</span>
    nrow <span class="op">=</span> <span class="fl">9</span>, 
    byrow <span class="op">=</span> <span class="cn">TRUE</span>,
    dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"VC1"</span>, <span class="st">"VC2"</span>, <span class="st">"VC3"</span>, 
        <span class="st">"WM1"</span>, <span class="st">"WM2"</span>, <span class="st">"WM3"</span>, 
        <span class="st">"RD1"</span>, <span class="st">"RD2"</span>, <span class="st">"RD3"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Vocabulary"</span>, <span class="st">"WorkingMemory"</span>, <span class="st">"Reading"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></pre></div>
</div>
<div id="the-structural-model" class="section level2">
<h2 class="hasAnchor">
<a href="#the-structural-model" class="anchor"></a>The structural model</h2>
<p>The structural model can be specified with a matrix in which the predictors are the column names and the criterion variables are the row names.</p>
<p>Here we have Vocabulary and Working Memory Capacity predicting Reading Scores.</p>
<div class="sourceCode" id="cb19"><pre class="downlit">
<span class="va">m_struct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.4</span>,<span class="fl">0.3</span><span class="op">)</span>, 
    ncol <span class="op">=</span> <span class="fl">2</span>,
    dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      <span class="st">"Reading"</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Vocabulary"</span>, <span class="st">"WorkingMemory"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </pre></div>
<p>This could have been a 3 by 3 matrix with zeroes (which are ignored).</p>
<div class="sourceCode" id="cb20"><pre class="downlit">
<span class="va">m_struct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="fl">0</span>,   <span class="fl">0</span>,   <span class="fl">0</span>,  <span class="co"># Vocabulary</span>
    <span class="fl">0</span>,   <span class="fl">0</span>,   <span class="fl">0</span>,  <span class="co"># WorkingMemory</span>
    <span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0</span><span class="op">)</span>, <span class="co"># Reading</span>
    nrow <span class="op">=</span> <span class="fl">3</span>, 
    byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> 
<span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">m_struct</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Vocabulary"</span>, <span class="st">"WorkingMemory"</span>, <span class="st">"Reading"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">m_struct</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Vocabulary"</span>, <span class="st">"WorkingMemory"</span>, <span class="st">"Reading"</span><span class="op">)</span></pre></div>
</div>
<div id="covariances" class="section level2">
<h2 class="hasAnchor">
<a href="#covariances" class="anchor"></a>Covariances</h2>
<p>The variances and covariances must be specified as a symmetric matrix, though variables can be omitted.</p>
<p>Here we specify that the latent variables Vocabulary and Working Memory Capacity are correlated.</p>
<div class="sourceCode" id="cb21"><pre class="downlit">
<span class="va">m_cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="fl">1</span>,   <span class="fl">0.5</span>, 
    <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, 
    nrow <span class="op">=</span> <span class="fl">2</span>,
    dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Vocabulary"</span>, <span class="st">"WorkingMemory"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Vocabulary"</span>, <span class="st">"WorkingMemory"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </pre></div>
</div>
<div id="using-the-matrix2lavaan-function" class="section level2">
<h2 class="hasAnchor">
<a href="#using-the-matrix2lavaan-function" class="anchor"></a>Using the <code>matrix2lavaan</code> function</h2>
<p>The <code>matrix2lavaan</code> function takes arguments for the measurement model, structural model, and covariances. Any of the three matrices can be omitted.</p>
<div class="sourceCode" id="cb22"><pre class="downlit">
<span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/matrix2lavaan.html">matrix2lavaan</a></span><span class="op">(</span>measurement_model <span class="op">=</span> <span class="va">m_meas</span>, 
                       structural_model <span class="op">=</span> <span class="va">m_struct</span>, 
                       covariances <span class="op">=</span> <span class="va">m_cov</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>
<span class="co">#&gt; Vocabulary =~ 0.8 * VC1 + 0.9 * VC2 + 0.7 * VC3</span>
<span class="co">#&gt; WorkingMemory =~ 0.6 * WM1 + 0.7 * WM2 + 0.8 * WM3</span>
<span class="co">#&gt; Reading =~ 0.9 * RD1 + 0.7 * RD2 + 0.8 * RD3</span>
<span class="co">#&gt; Reading ~ 0.4 * Vocabulary + 0.3 * WorkingMemory</span>
<span class="co">#&gt; Vocabulary ~~ 0.5 * WorkingMemory</span></pre></div>
</div>
<div id="specifying-models-with-data-frames-instead-of-matrices" class="section level2">
<h2 class="hasAnchor">
<a href="#specifying-models-with-data-frames-instead-of-matrices" class="anchor"></a>Specifying models with data.frames instead of matrices</h2>
<p>As an alternative, the <code>matrix2lavaan</code> function can take data.frames (or tibbles) with either rownames or the first column as a character vector.</p>
<div class="sourceCode" id="cb23"><pre class="downlit">
<span class="co"># A tibble with indicator variables listed in the first column</span>
<span class="va">m_meas</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
     <span class="op">~</span><span class="va">Test</span>, <span class="op">~</span><span class="va">Vocabulary</span>, <span class="op">~</span><span class="va">WorkingMemory</span>, <span class="op">~</span><span class="va">Reading</span>,
     <span class="st">"VC1"</span>,         <span class="fl">0.8</span>,              <span class="fl">0</span>,        <span class="fl">0</span>,
     <span class="st">"VC2"</span>,         <span class="fl">0.9</span>,              <span class="fl">0</span>,        <span class="fl">0</span>,
     <span class="st">"VC3"</span>,         <span class="fl">0.7</span>,              <span class="fl">0</span>,        <span class="fl">0</span>,
     <span class="st">"WM1"</span>,           <span class="fl">0</span>,            <span class="fl">0.6</span>,        <span class="fl">0</span>,
     <span class="st">"WM2"</span>,           <span class="fl">0</span>,            <span class="fl">0.7</span>,        <span class="fl">0</span>,
     <span class="st">"WM3"</span>,           <span class="fl">0</span>,            <span class="fl">0.8</span>,        <span class="fl">0</span>,
     <span class="st">"RD1"</span>,           <span class="fl">0</span>,              <span class="fl">0</span>,      <span class="fl">0.9</span>,
     <span class="st">"RD2"</span>,           <span class="fl">0</span>,              <span class="fl">0</span>,      <span class="fl">0.7</span>,
     <span class="st">"RD3"</span>,           <span class="fl">0</span>,              <span class="fl">0</span>,      <span class="fl">0.8</span><span class="op">)</span>

<span class="co"># A data.frame with criterion variable specified as a row name</span>
<span class="va">m_struct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Vocabulary <span class="op">=</span> <span class="fl">0.4</span>, 
                       WorkingMemory <span class="op">=</span> <span class="fl">0.3</span>, 
                       row.names <span class="op">=</span> <span class="st">"Reading"</span><span class="op">)</span>

<span class="co"># A data.frame with variable names specified as row names</span>
<span class="va">m_cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Vocabulary <span class="op">=</span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>,
                    WorkingMemory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">m_cov</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Vocabulary"</span>, <span class="st">"WorkingMemory"</span><span class="op">)</span>


<span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/matrix2lavaan.html">matrix2lavaan</a></span><span class="op">(</span>measurement_model <span class="op">=</span> <span class="va">m_meas</span>, 
                       structural_model <span class="op">=</span> <span class="va">m_struct</span>, 
                       covariances <span class="op">=</span> <span class="va">m_cov</span><span class="op">)</span></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by W. Joel Schneider.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
